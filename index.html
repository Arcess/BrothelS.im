<!DOCTYPE html>
<html><head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Script-Type" content="text/javascript">
  <title>Brothel S.im</title>
  <link rel="shortcut icon" href="favicon.ico">
  <link href="libraries/ui-darkness.css" type="text/css" rel="stylesheet">
  <script src="libraries/jquery.js"></script>
  <script src="libraries/jquery-ui.js"></script>
  <script src="libraries/cycle.js"></script>
  <script src="libraries/globalize.js"></script>
  <script src="libraries/ejs.js"></script>
  <script src="libraries/namegen.js"></script>
  <script src="libraries/superfish.js"></script>
  <script src="libraries/hoverIntent.js"></script>
  <script src="libraries/jquery.sparkline.js"></script>
  <script src="libraries/jquery.sparkline.js"></script>

  <link href="modules/style.css" type="text/css" rel="stylesheet">
  <script src="modules/core.js"></script>
  <link href="modules/autorender/autorender.css" type="text/css" rel="stylesheet">
  <script src="modules/autorender/autorender.js"></script>
  <script src="modules/game/schema.js"></script>
  <script src="modules/game/game.js"></script>
  <script src="content/game.js"></script>
  <link href="modules/messages/messages.css" type="text/css" rel="stylesheet">
  <script src="modules/messages/messages.js"></script>

  <!-- Girls !-->
  <link href="modules/girls/style.css" type="text/css" rel="stylesheet">
  <script src="modules/girls/schema.js"></script>
  <script src="modules/girls/girls.js"></script>
  <script src="content/girls/girls.js"></script>

  <script src="content/girls/Kirino/base.js"></script>
  <script src="content/girls/Sophitia/base.js"></script>
  <script src="content/girls/Sakuya/base.js"></script>
  <script src="content/girls/DarkMagicianGirl/base.js"></script>
  <script src="content/girls/Yuna/base.js"></script>
  <script src="content/girls/Jill/base.js"></script>

  <!-- Buildings !-->
  <link href="modules/buildings/style.css" type="text/css" rel="stylesheet">
  <script src="modules/buildings/schema.js"></script>
  <script src="modules/buildings/buildings.js"></script>
  <script src="modules/buildings/rooms.js"></script>
  <script src="content/buildings/buildings.js"></script>

  <script src="content/buildings/Onsen/base.js"></script>
  <script src="content/buildings/Theater/base.js"></script>

  <!-- Missions !-->
  <link href="modules/missions/style.css" type="text/css" rel="stylesheet">
  <script src="modules/missions/schema.js"></script>
  <script src="modules/missions/missions.js"></script>

  <script src="content/missions/intro.js"></script>
  <script src="content/missions/specialParty.js"></script>
  <script src="content/missions/tentacleAttacks.js"></script>

  <!-- Events !-->
  <script src="modules/events/events.js"></script>

  <script src="content/events/tentacleAttack.js"></script>
  <script src="content/events/rape.js"></script>

  <!-- Actions !-->
  <script src="content/actions/specialParty.js"></script>
  <script src="content/actions/Prostitution.js"></script>
  <script src="content/actions/Schools.js"></script>
  <script src="content/actions/Simple.js"></script>

  <!-- Misc modules !-->
  <script src="modules/randomPerson/randomPerson.js"></script>
  <script src="content/randomPerson/randomPerson.js"></script>

  <script src="modules/prostitution/prostitution.js"></script>
  <script src="content/prostitution.js"></script>

  <script src="modules/owner/owner.js"></script>

  <script>
    $(function() {
      e.invokeAll("Ready", Game.load);
    });
  </script>
</head>
<body>
  <div id="header-wrapper">
    <div id="header">
      <img src="content/miscImages/logo.png">
      <ul>
        <li><a href="http://site.brothels.im">Site</a></li>
        <li><a id="save">Save</a></li>
        <li><a id="load">Load</a></li>
        <li><a id="new">New</a></li>
      </ul>
    </div>
  </div>
  <div id="menu"></div>
  <div id="content-wrapper">
    <div id="content" class="ui-helper-clearfix">
      <img src="content/miscImages/loader.gif" style="display: block; margin: 10em auto 0px;">
    </div>
  </div>
  <script id="messages_list_template" type="text/ejs-template">
    << function renderDelta(delta) { >>
      <div class="message-delta">
        << $.each(delta, function(stat, value) {
          var text;
          if (stat == 'money') {
            text = value < 0 ? '-$' + (-value) : '+$' + value;
          } else {
            text = value < 0 ? value : '+' + value;
          } >>
          <span class="delta <<= stat >>"><<= text >></span>
        << }) >>
      </div>
    <<} >>

    <div class="vertical-tabs navigable" id="messages">
      <ul>
        << var i = 0 >>
        << for (var subject in messages) { >>
          << i++ >>
          <li>
            <a href="#message-tab-<<= i >>"><<= subject >></a>
          </li>
        << } >>
      </ul>
      << i = 0 >>
      << $.each(messages, function(subject, sub_messages) { >>
        << i++ >>
        << var time = '' >>
        <div id="message-tab-<<= i >>" class="accordion"><< sub_messages.forEach(function(message) { >>
          << var text = message.type >>
          << if (message.time && message.time != time) {
              time = message.time;
              text = time.capitalize() + ' - ' + text;
          } >>
          <h3><<- text >></h3>
          <div class="message ui-helper-clearfix <<= message.text.length > 300 ? 'long' : '' >>">
            <img src="<<= message.image >>">
            << if (message.delta && !$.isEmptyObject(message.delta)) { renderDelta(message.delta); } >>
            <div class="message-content">
              <<- message.text >>
            </div>
          </div>
        << }) >></div>
      << }) >>
    </div>
  </script>
  <script id="girls_hire_template" type="text/ejs-template">
    <div id="hire-girls">
      << girls.forEach(function(girl) { >>
        <div class="ui-helper-clearfix no-cursor girl" name="<<= girl.name >>">
          <div class="column pct-20">
            <img src="<<= girl.image("base") >>" title="<<= girl._.description >>">
          </div>
          <div class="column pct-40 center">
            <h6><<= girl.name >></h6>
            <<
              var stats = [], experience = [], libido = [];
              Girl.stats.forEach(function(stat) {
                if (stat == "happiness" || stat == "endurance") { return; }
                stats.push(girl.S(stat));
              });
              Girl.sex.forEach(function(sex) {
                experience.push(girl.S(sex + " experience"));
                libido.push(girl.S(sex + " libido"));
              });
            >>
            <div><<- stats.join(" | ") >></div>
            <div><<- libido.join(" | ") >></div>
            <div><<- experience.join(" | ") >></div>
          </div>
          <div class="column pct-40">
            <div><label>Up Front:</label><strong class="money">$<<= girl.hirePrice() >></strong></div>
            <div><label>Daily:</label><strong class="money">$<<= girl.desiredPay() >></strong></div>
            <button class="hire" name="<<= girl.name >>">Hire</button>
          </div>
        </div>
      << }) >>
    </div>
  </script>
  <script id="girls_list_template" type="text/ejs-template">
    <div class="column pct-50" id="girls">
      << if (girls.length < g.maxGirls) { >>
        <h3 class="center">
          <a id="hire-girl">Hire Girl</a>
        </h3>
      << } >>
      << girls.forEach(function(girl) { >>
        <div class="ui-helper-clearfix no-cursor girl" name="<<= girl.name >>">
          <div class="column pct-20">
            <img src="<<= girl.image('base') >>">
          </div>
          <div class="column pct-40 center">
            <h6><<= girl.name >></h6>
            <div><<- girl.S("endurance") >> | <<- girl.S("happiness") >></div>
            <<
              var stats = [];
              Girl.stats.forEach(function(stat) {
                if (stat != "endurance" && stat != "happiness") {
                  stats.push(girl.S(stat));
                }
              });
            >>
            <div>
              <<- stats.join(" | ") >>
            </div>
          </div>
          <div class="column pct-40">
            <div>Morning: <strong><<= girl.actions.morningLabel >></strong></div>
            <div>Evening: <strong><<= girl.actions.eveningLabel >></strong></div>
          </div>
        </div>
      << }) >>
    </div>
  </script>
  <script id="girls_view_template" type="text/ejs-template">
    << function createActionsList(list, doing) { >>
      <ul class="sf-menu">
        <li>
          <a><<= doing >></a>
          <ul><< $.each(list.CsortToObject('group'), function(group, actions) { >>
            <li name="<<= group >>">
              <a><<= group >></a>
              <ul>
                << actions.forEach(function(action) { >>
                  <li class="<<= action.disabled ? 'disabled' : '' >>" name="<<= action._id >>">
                    <a class="<<= action.options ? '' : 'action'>>" title="<<= action.description >>"><<= action.label >></a>
                    << if (action.options) { >>
                      <ul>
                        << $.each(action.options, function(key, value) { >>
                          <li name="<<= action._id >>" class="<<= action.disabled ? 'disabled' : '' >>">
                            <a class="action" name="<<=key >>"><<- value >></a></li>
                        << }) >>
                      </ul>
                    << } >>
                  </li>
                << }) >>
              </ul>
            </li>
          << }) >></ul>
        </li>
      <ul>
    << } >>
    <div id="girl-view" name="<<= girl.name >>" class="ui-helper-clearfix">
      <div class="column pct-30 left center">
        <img src="<<= girl.image("base") >>" title="<<= girl._.description >>">
          <div id="morning" class="action-list">
            << createActionsList(morningActions, girl.actions.morningLabel) >>
          </div>
          <div id="evening" class="action-list">
            << createActionsList(eveningActions, girl.actions.eveningLabel) >>
          </div>
      </div>
      <div class="column pct-70">
        <div class="column pct-55 middle">
          << Girl.stats.forEach(function(stat) { >>
            <div>
              <label><<- T(stat) >></label>
              <<- girl.S(stat) >>
            </div>
          << }); >>
          <div id="pay">
            <label><strong>Pay</strong></label>
            <input value="$<<= girl.actions.pay >>">
            <span class="delta happiness"></span>
          </div>
        </div>
        <div class="column pct-45 right">
          << Girl.sex.forEach(function(sex) { >>
            <div>
              <label class="checkbox <<= girl.actions[sex] ? 'checked' : '' >>" id="<<= sex >>">
                <<- T(sex) >>
              </label>
            </div>
            <div>
              <label><<- T("libido") >>:</label>
              <span class="<<= sex >> libido">
                <<- girl.S(sex + " libido") >>
              </span>
            </div>
            <div>
              <label><<- T("experience") >>:</label>
              <span class="<<= sex >> experience">
                <<- girl.S(sex + " experience") >>
              </span>
            </div>
          << }) >>
        </div>
      </div>
    </div>
  </script>
  <script id="game_view_template" type="text/ejs-template">
    <div class="ui-helper-clearfix first">
      <div id="top-left" class="column pct-50 center">
        <h2>Day <<= g.day >></h2>
        <div>
          Cash on hand:
          <strong class="money"><<= g.money < 0 ? "-$" + (-g.money) : "$" + g.money >></strong>
        </div>
        << if (g.moneyHistory.length > 5) { >>
          <div class="bar-sparkline"><<= g.moneyHistory.join(",")>></div>
        << } >>
        <div>
          Payment of
          <strong class="money">$<<= g.nextPayment().amount >></strong>
          due on day
          <span class="days"><<= g.nextPayment().day >></span>
        </div>
        <div>
          <span class="days"><<= gameLength - g.day >> days</span>
          to end of debt
        </div>
      </div>
      <div id="top-right" class="column pct-50 center">
        <button id="next" class="big">Next Turn</button>
      </div>
    </div>
    <hr>
    <div class="ui-helper-clearfix second"></div>
  </script>
  <script id="game_load_template" type="text/ejs-template">
    <form id="load-game-form" class="center">
      <div>
        <select required="required" id="game-name">
          << games.forEach(function(name) { >>
            <option value="<<= name >>"><<= name >></option>
          << }) >>
        </select>
      </div>
      <button id="load-game">Load Game</button>
      <button id="delete-game">Delete Game</button>
      <textarea></textarea>
      <button id="import-game">Import Game</button>
    </form>
  </script>
  <script id="game_new_template" type="text/ejs-template">
    <form id="new-game-form">
      <div id="fetishes">
        << Game.fetishes.forEach(function(fetish) { >>
          <label class="checkbox" <<= g.fetishes && g.fetishes[fetish] ? 'checked="checked"' : '' >> name="<<= fetish >>" title="<<- Game.fetishDescriptions[fetish] >>"><<= fetish.capitalize() >></label>
        << }) >>
      </div>
      <button>Start Game</button>
    </form>
  </script>
  <script id="game_save_template" type="text/ejs-template">
    <form id="save-game-form">
      <div>
        <label title="If you use the same name as another saved game, the other save will be overwritten." for="game-name">Title</label>
        <input required="required" id="game-name">
      </div>
      <button id="save-game">Save Game</button><button id="export-game">Export Game</button
    </form>
  </script>
  <script id="game_intro_template" type="text/ejs-template">
    <div class="column pct-30">
      <img width="100%" src="content/girls/Kirino/images/Base.png">
    </div>
    <div class="column pct-70">
      <p>You wake up somewhat disoriented, to the gentle sound of surf and a cawing gull. It's hard to see too much more, with the bright sunlight and a buxom young chest covering most of your view. Not an unpleasant way to wake...</p>
      <blockquote>
        <p>Welcome to Valaia! Since it doesn't look like you came here intentionally, let me explain a bit about out fine country. This is an island nation, but isolated - oh not at all. We're rather central, in fact, easily accessible by sea from almost anywhere in the world. And visit us they do - diplomats, kings, nobles and peasants alike know our name. Why, you ask? Because we provide the <b>finest whores in the world!</b></p>
        <p>But anyway, given that it looks like you washed ashore with nothing but the clothes on your back, I'm going to guess that you're not here to visit our world-famous whores.</p>
        <p>What's that? You were tossed overboard because of a <b>massive debt</b>? Only <b>two years</b> to do it, or they'll come back and gut you like a fish? Well, this is a pretty good place for that too. Plenty of pretty girls just itching for employment, plenty of rich visitors itching in a slightly different fashion...</p>
        <p>You're going to <b>start a brothel</b>? My last venture went under, and, to be honest, I'm in pretty dire need of work myself. Since you're new around here, <b>I'll be your first girl</b> and your guide.</p>
        <p><b>Excellent!</b> Let's get started right away.</p>
      </blockquote>
    </div>
  </script>
  <script id="buildings_view_template" type="text/ejs-template">
    <div id="building-view" name="<<= building.name >>" class="ui-helper-clearfix">
      <div class="column pct-30 left">
        <img src="<<= building._.image >>" title="<<= building._.description >>">
      </div>
      <div class="column pct-70">
        <div class="column pct-50 middle">
          <div><label>Reputation:</label><<- building.S("reputation") >></div>
          <div><label>Clean:</label><<- building.S("clean") >></div>
          <div><label>Rooms:</label><<- building.S("rooms") >></div>
          <div>
            <label id="daily-label">Daily:</label>
            <div class="daily-delta"><< $.each(building.dailyDelta(), function(stat, value) {
              var text;
              if (stat == 'money') {
                text = value < 0 ? '-$' + (-value) : '+$' + value;
              } else {
                text = value < 0 ? '' + value : '+' + value;
              } >>
              <span class="delta <<= stat >>"><<= text.substr(0, 5) >></span>
            << }) >></div>
          </div>
        </div>
        <div class="column pct-50 right center">
          << if (building.rooms.length < building._.maxRooms && !$.isEmptyObject(availableRooms)) { >>
            <select id='new-room'>
              << $.each(availableRooms, function(name, room) { >>
                <option value="<<= name >>" title="<<= room.description >>">$<<= room.price >> - <<= name.capitalize() >></option>
              << }) >>
            </select>
            <button id="buy-room">Add Room</button>
          << } >>
        </div>
        <div id="rooms" class="ui-helper-clearfix">
        </div>
      </div>
    </div>
  </script>
  <script id="buildings_list_template" type="text/ejs-template">
    <div class="column pct-50" id="buildings">
      << if (buildings.length < g.maxBuildings) { >>
        <h3 class="center">
          <a id="buy-building">Buy Building</a>
        </h3>
      << } >>
      << buildings.forEach(function(building) { >>
        <div class="ui-helper-clearfix no-cursor building" name="<<= building.name >>">
          <div class="column pct-20">
            <img src="<<= building._.image >>">
          </div>
          <div class="column pct-40 middle">
            <h6 class="center"><<= building.name >></h6>
            <div><label>Reputation:</label><<- building.S("reputation") >></div>
            <div><label>Clean:</label><<- building.S("clean") >></div>
            <div><label>Rooms:</label><<- building.S("rooms") >></div>
          </div>
          <div class="column pct-40 right center">
            <div><strong>Residents</strong></div>
            << building.rooms.Caccumulate('girl').forEach(function(name) { >>
              <div><<= name >></div>
            << }) >>
          </div>
        </div>
      << }) >>
    </div>
  </script>
  <script id="buildings_buy_template" type="text/ejs-template">
    <div id="buy-buildings">
      << buildings.forEach(function(building) { >>
        <div class="ui-helper-clearfix no-cursor building" name="<<= building.name >>">
          <div class="column pct-30">
            <img src="<<= building._.image >>" title="<<= building._.description >>">
          </div>
          <div class="column pct-40 middle">
            <h6 class="center"><<= building.name >></h6>
            <div><label>Reputation:</label><<- building.S("reputation") >></div>
            <div><label>Clean:</label><<- building.S("clean") >></div>
            <div><label>Rooms:</label><<- building.S("rooms") >></div>
            << building.rooms.forEach(function (room) { >>
              <div class="room <<= room.type >>"><<= room.type.capitalize() >></div>
            << }) >>
          </div>
          <div class="column pct-30 right">
            <div><label>Price:</label><strong class="money">$<<= building.price() >></strong></div>
            <div>
              <label>Daily:</label>
              <div class="daily-delta">
                << $.each(building.dailyDelta(), function(stat, value) {
                  var text;
                  if (stat == 'money') {
                    text = value < 0 ? '-$' + (-value) : '+$' + value;
                  } else {
                    text = value < 0 ? '' + value : '+' + value;
                  } >>
                  <span class="delta <<= stat >>"><<= text.substr(0, 5) >></span>
                << }) >>
              </div>
            </div>
            <button class="buy" name="<<= building.name >>">Buy</button>
          </div>
        </div>
      << }) >>
    </div>
  </script>
  <script id="buildings_bedroom_template" type="text/ejs-template">
    <div>
      <h6>Bedroom</h6>
      <select name="girl" title="Select the girl living in this room. When a girl has a place to live, she demands a significantly lower wage.">
        <option value="" <<= (room.girl) ? '' : 'selected' >>> - Empty - </option>
        << girls.forEach(function(girl) { >>
          <option value="<<= girl.name >>" <<= (room.girl == girl.name) ? 'selected' : '' >>>
            <<= girl.name >>
          </option>
        << }) >>
      </select>
    </div>
  </script>
  <script id="missions_list_template" type="text/ejs-template">
    <div class="vertical-tabs navigable" id="mission-list">
      <ul>
        << var i = 0 >>
        << for (var _id in missions) { >>
          << i++ >>
          <li>
            <a href="#mission-tab-<<= i >>"><<= missions[_id].label >></a>
          </li>
        << } >>
      </ul>
      << i = 0 >>
      << $.each(missions, function(_id, mission) { >>
        << i++ >>
        <div id="mission-tab-<<= i >>" class="mission ui-helper-clearfix">
          << if (mission.end.day) { >>
            <div class="top">Time Remaining: <strong><<= mission.end.day - g.day >> days</strong></div>
          << } >>
          <img src="<<= mission.image >>">
          <div>
            <<- mission.description >>
          </div>
        </div>
      << }) >>
    </div>
  </script>
</body></html>