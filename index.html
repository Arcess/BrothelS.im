<!DOCTYPE html>
<html><head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Script-Type" content="text/javascript">
  <title>Brothel S.im</title>
  <link rel="shortcut icon" href="favicon.ico">
  <link href="libraries/ui-darkness.css" type="text/css" rel="stylesheet">
  <script src="libraries/jquery-1.9.js"></script>
  <script src="libraries/jquery-ui-1.10.js"></script>
  <script src="libraries/globalize.js"></script>
  <script src="libraries/ejs.js"></script>
  <script src="libraries/namegen.js"></script>
  <script src="libraries/jquery.sparkline.min.js"></script>
  <script type="text/javascript" src="libraries/tv4.js"></script>

  <link href="modules/style.css" type="text/css" rel="stylesheet">
  <link href="modules/autorender/autorender.css" type="text/css" rel="stylesheet">
  <script src="modules/core.js"></script>
  <script src="modules/autorender/autorender.js"></script>
  <script src="modules/game/class.js"></script>
  <script src="modules/game/game.js"></script>
  <script src="content/game.js"></script>
  <link href="modules/messages/messages.css" type="text/css" rel="stylesheet">
  <script src="modules/messages/messages.js"></script>

  <!-- Girl core files -->
  <link href="modules/girls/style.css" type="text/css" rel="stylesheet">
  <script src="modules/girls/class.js"></script>
  <script src="content/girls/girls.js"></script>
  <script src="modules/girls/girls.js"></script>

  <!-- Building core files -->
  <link href="modules/buildings/style.css" type="text/css" rel="stylesheet">
  <script src="modules/buildings/class.js"></script>
  <script src="modules/buildings/rooms.js"></script>
  <script src="modules/buildings/buildings.js"></script>
  <script src="content/buildings/buildings.js"></script>
  <script src="content/buildings/rooms.js"></script>

  <!-- Mission core files -->
  <link href="modules/missions/style.css" type="text/css" rel="stylesheet">
  <script src="modules/missions/resolvable.js"></script>
  <script src="modules/missions/class.js"></script>
  <script src="modules/missions/missions.js"></script>

  <!-- Action core files -->
  <link href="modules/actions/style.css" type="text/css" rel="stylesheet">
  <script src="modules/actions/class.js"></script>
  <script src="modules/actions/actions.js"></script>

  <!-- Misc modules -->
  <script src="modules/events/events.js"></script>
  <script src="modules/randomPerson/randomPerson.js"></script>
  <script src="content/randomPerson/randomPerson.js"></script>
  <script src="modules/owner/owner.js"></script>

  <!--   Uncomment the following section in order to enable schema validation. -->
  <!--   This will massively slow down game loading and play. -->
  <script src="modules/game/schema.js"></script>
  <script src="modules/girls/schema.js"></script>
  <script src="modules/messages/schema.js"></script>
  <script src="modules/buildings/schema.js"></script>
  <script src="modules/missions/schema.js"></script>
  <script src="modules/actions/schema.js"></script>
  <script src="modules/events/schema.js"></script>
  <script src="modules/validator/validate.js"></script>

  <!-- Actions -->
  <script src="content/actions/chores.js"></script>
  <script src="content/actions/jobs.js"></script>
  <script src="content/actions/training.js"></script>
  <script src="content/actions/specialParty.js"></script>

  <!-- Girls -->
  <script src="content/girls/Kirino/base.js"></script>
  <script src="content/girls/Sophitia/base.js"></script>
  <script src="content/girls/Sakuya/base.js"></script>
  <script src="content/girls/DarkMagicianGirl/base.js"></script>
  <script src="content/girls/Yuna/base.js"></script>
  <script src="content/girls/Jill/base.js"></script>

  <!-- Buildings -->
  <script src="content/buildings/Onsen/base.js"></script>
  <script src="content/buildings/Theater/base.js"></script>

  <!-- Missions -->
  <script src="content/missions/intro.js"></script>
  <script src="content/missions/specialParty.js"></script>
  <script src="content/missions/tentacleAttacks.js"></script>
  <script src="content/missions/avengeRape.js"></script>

  <!-- Events !-->
  <script src="content/events/tentacleAttack.js"></script>
  <script src="content/events/rape.js"></script>

  <!-- Misc files -->
  <script src="modules/prostitution/prostitution.js"></script>
  <script src="content/prostitution.js"></script>

  <script>
    $(function() {
      e.invokeAll("Ready", Game.load);
    });
  </script>
</head>
<body>
  <div id="header-wrapper">
    <div id="header">
      <img src="content/miscImages/logo.png">
      <ul>
        <li><a href="http://site.brothels.im">Site</a></li>
        <li><a id="save">Save</a></li>
        <li><a id="load">Load</a></li>
        <li><a id="new">New</a></li>
      </ul>
    </div>
  </div>
  <div id="menu"></div>
  <div id="content-wrapper">
    <div id="content" class="ui-helper-clearfix">
      <img src="content/miscImages/loader.gif" style="display: block; margin: 10em auto 0px;">
    </div>
  </div>
  <div id="error"></div>
  <script id="render_delta_template" type="text/ejs-template">
    << $.each(delta, function(stat, value) {
      var text;
      if (typeof(value) == 'object') {
        text = ejs.render($('#render_delta_template').html(), { delta: value });
      } else if (stat == 'money') {
        text = value < 0 ? '-$' + (-value) : '+$' + value;
        stat += ' delta';
      } else {
        text = value < 0 ? value : '+' + value;
        stat += ' delta';
      } >>
      <span class="<<- stat >>"><<- text >></span>
    << }) >>
  </script>
  <script id="messages_list_template" type="text/ejs-template">
    <div class="vertical-tabs navigable" id="messages">
      <ul>
        << for (var i in groups) { >>
          <li>
            <a href="#message-tab-<<- i >>"><<- groups[i] >></a>
          </li>
        << } >>
      </ul>
      << for (i in groups) { >>
        << var time = '' >>
        <div id="message-tab-<<- i >>" class="accordion"><< messages[groups[i]]._sort("weight").forEach( function(message) { >>
          << var text = message.label >>
          << if (message.time && message.time != time) {
              time = message.time;
              text = time.capitalize() + ' - ' + text;
          } >>
          <h3><<- text >></h3>
          <div class="message ui-helper-clearfix <<- message.text.length > 300 ? 'long' : '' >>">
            <img src="<<- message.image >>">
            << if (message.delta && !$.isEmptyObject(message.delta)) { >>
              <div class="message-delta">
                <<- ejs.render($('#render_delta_template').html(), { delta: message.delta }) >>
              </div>
            << } >>
            <div class="message-content">
              <<- message.text >>
            </div>
          </div>
        << }) >></div>
      << } >>
    </div>
  </script>
  <script id="girls_hire_template" type="text/ejs-template">
    <div id="hire-girls" class="vertical-tabs navigable">
      <ul>
        << for(var i in girls) { >>
          <li>
            <a href="#hire-tab-<<- i >>"><<- girls[i].name >></a>
          </li>
        << } >>
      </ul>
      << i = 0 >>
      << girls.forEach(function(girl) { >>
        <div id="hire-tab-<<- i >>" class="no-cursor girl" name="<<- girl.name >>">
          <div class="column pct-30">
            <img src="<<- girl.image("base") >>" title="<<= girl.base().description >>">
          </div>
          <div class="column pct-40 center">
            <h6><<- girl.name >></h6>
            <<
              i++;
              var stats = [], experience = [], libido = [];
              Girl.stats.forEach(function(stat) {
                if (stat == "happiness" || stat == "endurance") { return; }
                stats.push(girl.S(stat));
              });
              Girl.sex.forEach(function(sex) {
                experience.push(girl.S(sex + "Experience"));
                libido.push(girl.S(sex + "Libido"));
              });
            >>
            <div><<- stats.join(" | ") >></div>
            <div><<- libido.join(" | ") >></div>
            <div><<- experience.join(" | ") >></div>
          </div>
          <div class="column pct-30">
            <div><label>Up Front:</label><strong class="money">$<<- girl.hirePrice() >></strong></div>
            <div><label>Daily:</label><strong class="money">$<<- girl.desiredPay() >></strong></div>
            <button class="hire" name="<<- girl.name >>">Hire</button>
          </div>
        </div>
      << }) >>
    </div>
  </script>
  <script id="girls_list_template" type="text/ejs-template">
    <div class="column pct-50" id="girls">
      << if (girls.length < g.maxGirls) { >>
        <h3 class="center">
          <a id="hire-girl">Hire Girl</a>
        </h3>
      << } >>
      << girls.forEach(function(girl) { >>
        <div class="ui-helper-clearfix no-cursor girl" name="<<- girl.name >>">
          <div class="column pct-20 left">
            <img src="<<- girl.image('base') >>">
          </div>
          <div class="column pct-40 center middle">
            <h6><<- girl.name >></h6>
            <div><<- girl.S("endurance") >> | <<- girl.S("happiness") >></div>
            <<
              var stats = [];
              Girl.stats.forEach(function(stat) {
                if (stat != "endurance" && stat != "happiness") {
                  stats.push(girl.S(stat));
                }
              });
            >>
            <div>
              <<- stats.join(" | ") >>
            </div>
          </div>
          <div class="column pct-40 right">
            <div name="morning">Morning: <strong><<- girl.actions.morning.label >></strong></div>
            <div name="evening">Evening: <strong><<- girl.actions.evening.label >></strong></div>
          </div>
        </div>
      << }) >>
    </div>
  </script>
  <script id="girls_view_template" type="text/ejs-template">
    <div class="vertical-tabs navigable">
      <ul>
        << for (var i in girls) { >>
          <li><a href="#girl-tab-<<- i >>"><<- girls[i].name >></a></li>
        << } >>
      </ul>
      << for (i in girls) { >>
        <div id="girl-tab-<<- i >>" class="<<- (girl.name == girls[i].name) ? 'active' : '' >>">
          <<- ejs.render($('#girls_view_one_template').html(), { girl: girls[i] }) >>
        </div>
      << } >>
    </div>
  </script>
  <script id="girls_view_one_template" type="text/ejs-template">
    <div name="<<- girl.name >>" class="ui-helper-clearfix girl-view">
      <div class="column pct-30 left center">
        <img src="<<- girl.image('base') >>" title="<<= girl.base().description >>">
      </div>
      <div class="column pct-70">
        <div class="column pct-55 middle">
          << Girl.stats.forEach(function(stat) { >>
            <div>
              <label><<- T(stat) >></label>
              <<- girl.S(stat) >>
            </div>
          << }) >>
          << if (g.missionsDone.firstMoney) { >>
            <div id="pay">
              <label><strong>Pay</strong></label>
              <div class="slider"></div>
              <div id="pay-results">
                <span class="delta money">$<<- Math.floor(girl.actions.pay * girl.desiredPay()) >></span>
                <span class="delta happiness"><<- girl.payHappiness() < 0 ? girl.payHappiness() : "+" + girl.payHappiness() >></span>
              </div>
            </div>
          << } >>
        </div>
        <div class="column pct-45 right">
          << Girl.sex.forEach(function(sex) { >>
            <div>
              <label class="checkbox <<- girl.actions[sex] ? 'checked' : '' >>" id="<<- sex >>">
                <<- T(sex) >>
              </label>
            </div>
            <div>
              <label><<- T("libido") >>:</label>
              <span class="<<- sex >> libido">
                <<- girl.S(sex + "Libido") >>
              </span>
            </div>
            <div>
              <label><<- T("experience") >>:</label>
              <span class="<<- sex >> experience">
                <<- girl.S(sex + "Experience") >>
              </span>
            </div>
          << }) >>
        </div>
      </div>
    </div>
  </script>
  <script id="game_view_template" type="text/ejs-template">
    <div class="ui-helper-clearfix first">
      <div id="top-left" class="column pct-50 center">
        <h2>Day <<- g.day >></h2>
        <div>
          Cash on hand:
          <strong class="money"><<- g.money < 0 ? "-$" + (-g.money) : "$" + g.money >></strong>
        </div>
        << if (g.moneyHistory.length > 5) { >>
          <div class="bar-sparkline"><<- g.moneyHistory.join(",") + "," + g.money >></div>
        << } >>
        << if (g.nextPayment()) { >>
          <div>
            Payment of
            <strong class="money">$<<- g.nextPayment().amount >></strong>
            due on day
            <span class="days"><<- g.nextPayment().day >></span>
          </div>
          <div>
            <span class="days"><<- Game.config.gameLength - g.day >> days</span>
            to end of debt
          </div>
        << } else { >>
          <div> Loan paid off - finally free!</div>
        << } >>
      </div>
      <div id="top-right" class="column pct-50 center">
        <button id="next" class="big">Next Turn</button>
      </div>
    </div>
    <hr>
    <div class="ui-helper-clearfix second"></div>
  </script>
  <script id="game_load_template" type="text/ejs-template">
    <div id="load-game-form" class="center">
      <div>
        <select required="required" id="game-name">
          << games.forEach(function(name) { >>
            <option value="<<- name >>"><<- name >></option>
          << }) >>
        </select>
      </div>
      <button id="load-game">Load Game</button>
      <button id="delete-game">Delete Game</button>
      <textarea></textarea>
      <button id="import-game">Import Game</button>
    </div>
  </script>
  <script id="game_new_template" type="text/ejs-template">
    <div id="new-game-form">
      <label id="autosave" class="checkbox" title="The game will be saved automatically before each turn.">Autosave</label>
      <label id="skip-intro" class="checkbox <<- g && g.missionsDone.explainWhore ? 'checked' : '' >>" title="Skip the tutorial missions and enable all options immediately.">Skip Tutorial</label>
      <div id="fetishes">
        <label title="Control what sorts of potentially objectionable content will show up in this game. You can modify them later from the Save Game dialog.">Fetishes</label>
        << Game.fetishes.forEach(function(fetish) { >>
          <div>
            <label class="checkbox <<- g && g.fetishes && g.fetishes[fetish] ? 'checked' : '' >>" name="<<- fetish >>" title="<<= Game.fetishDescriptions[fetish] >>"><<- fetish.capitalize() >></label>
          </div>
        << }) >>
      </div>
      <button>Start Game</button>
    </div>
  </script>
  <script id="game_save_template" type="text/ejs-template">
    <div id="save-game-form">
      <div>
        <label title="If you use the same name as another saved game, the other save will be overwritten." for="game-name">Title</label>
        <input required="required" id="game-name">
      </div>
      <label id="autosave" class="checkbox <<- g.autosave ? 'checked' : '' >>" title="The game will be saved after every third turn automatically.">Autosave</label>
      <div id="fetishes">
        <label title="You can turn fetishes on and off for the current game here.">Fetishes</label>
        << Game.fetishes.forEach(function(fetish) { >>
          <div>
            <label class="checkbox <<- g && g.fetishes && g.fetishes[fetish] ? 'checked' : '' >>" name="<<- fetish >>" title="<<= Game.fetishDescriptions[fetish] >>"><<- fetish.capitalize() >></label>
          </div>
        << }) >>
      </div>
      <button id="save-game">Save Game</button><button id="export-game">Export Game</button
    </div>
  </script>
  <script id="game_intro_template" type="text/ejs-template">
    <div class="column pct-30">
      <img width="100%" src="content/girls/Kirino/images/Base.png">
    </div>
    <div class="column pct-70">
      <p>You wake up somewhat disoriented, to the gentle sound of surf and a cawing gull. It's hard to see too much more, with the bright sunlight and a buxom young chest covering most of your view. Not an unpleasant way to wake...</p>
      <blockquote>
        <p>Welcome to Valaia! Since it doesn't look like you came here intentionally, let me explain a bit about out fine country. This is an island nation, but isolated - oh not at all. We're rather central, in fact, easily accessible by sea from almost anywhere in the world. And visit us they do - diplomats, kings, nobles and peasants alike know our name. Why, you ask? Because we provide the <b>finest whores in the world!</b></p>
        <p>But anyway, given that it looks like you washed ashore with nothing but the clothes on your back, I'm going to guess that you're not here to visit our world-famous whores.</p>
        <p>What's that? You were tossed overboard because of a <b>massive debt</b>? Only <b>two years</b> to do it, or they'll come back and gut you like a fish? Well, this is a pretty good place for that too. Plenty of pretty girls just itching for employment, plenty of rich visitors itching in a slightly different fashion...</p>
        <p>You're going to <b>start a brothel</b>? My last venture went under, and, to be honest, I'm in pretty dire need of work myself. Since you're new around here, <b>I'll be your first girl</b> and your guide.</p>
        <p><b>Excellent!</b> Let's get started right away.</p>
      </blockquote>
    </div>
  </script>
  <script id="game_user_input_template" type="text/ejs-template">
    <div class="ui-widget-overlay"></div>
    <div id="required-user-input" class="ui-helper-clearfix">
      <img src="<<- image >>">
      <p><<- text >></p>
      <hr class="clear">
      <div class="center">
        << $.each(options, function(value, label) { >>
          <button title="<<= label >>"><<- value >></button>
        << }) >>
      </div>
    </div>
  </script>
  <script id="buildings_view_template" type="text/ejs-template">
    <div id="building-view">
      << buildings.forEach(function(building) { >><div class="building ui-helper-clearfix" name="<<- building.name >>">
        <div class="column pct-75 left">
          <div class="info">
            <h6><<- building.name >></h6>
            <img src="<<- building.image() >>" title="<<= building.description() >>">
            <div class="daily-delta">
              <<- ejs.render($('#render_delta_template').html(), { delta: building.dailyDelta() }) >>
            </div>
          </div>
          <ul class="built-rooms"><< $.each(building.rooms, function(index, room) { >>
            <li class="room" name="<<- room.type >>" index="<<- index >>">
              <label><<- room.type >></label>
              << if (room.type == "Bedroom") { >><ul>
                << if (room.girl) { >>
                  <li class="girl" name="<<- room.girl >>">
                    <img src="<<- g.girls[room.girl].image() >>">
                  </li>
                << } >>
              </ul><< } >>
            </li>
          << }) >></ul>
        </div>
        <div class="column pct-25">
          <label>Available Rooms</label>
          <ul class="available-rooms">
            << building.potentialRooms()._sort("price").forEach(function(room) { >>
              <li class="room<<- room.price > g.money ? ' disabled' : ''>>" name="<<- room.type >>">
                <label>
                  <<- room.type >> - $<<- room.price >>
                </label>
                <p><<- room.description >></p>
              </li>
            << }) >>
          </ul>
        </div>
      </div><< }) >>
      <div>
        <h6>Inn</h6>
        <ul id="inn"><< inn_girls.forEach(function(girl) { >>
          <li class="girl" name="<<- girl.name >>">
            <img src="<<- girl.image() >>">
          </li>
        << }) >></ul>
      </div>
    </div>
  </script>
  <script id="buildings_list_template" type="text/ejs-template">
    <div class="column pct-50" id="buildings">
      << if (buildings.length < g.maxBuildings) { >>
        <h3 class="center">
          <a id="buy-building">Buy Building</a>
        </h3>
      << } >>
      << buildings.forEach(function(building) { >>
        <div class="ui-helper-clearfix no-cursor building" name="<<- building.name >>">
          <div class="column pct-20 left">
            <img src="<<- building.image() >>">
          </div>
          <div class="column pct-40 middle">
            <h6 class="center"><<- building.name >></h6>
            <div><label>Reputation:</label><<- building.S("reputation") >></div>
            <div><label>Clean:</label><<- building.S("clean") >></div>
            <div><label>Rooms:</label><<- building.S("rooms") >></div>
          </div>
          <div class="column pct-40 right center">
            <div><strong>Residents</strong></div>
            << building.rooms._accumulate('girl').forEach(function(name) { >>
              <div><<- name >></div>
            << }) >>
          </div>
        </div>
      << }) >>
    </div>
  </script>
  <script id="buildings_manage_template" type="text/ejs-template">
    <div id="manage-buildings">
      << buildings.forEach(function(building) { >>
        <div class="ui-helper-clearfix no-cursor building" name="<<- building.name >>">
          <div class="column pct-30">
            <img src="<<- building.image() >>" title="<<= building.description() >>">
          </div>
          <div class="column pct-40 middle">
            <h6 class="center"><<- building.name >></h6>
            <div><label>Reputation:</label><<- building.S("reputation") >></div>
            <div><label>Clean:</label><<- building.S("clean") >></div>
            <div><label>Rooms:</label><<- building.S("rooms") >></div>
            << building.rooms.forEach(function (room) { >>
              <div class="room <<- room.type >>"><<- room.type.capitalize() >></div>
            << }) >>
          </div>
          <div class="column pct-30 right">
            <div><label>Price:</label><strong class="money">$<<- building.price(action) >></strong></div>
            <div>
              <label>Daily:</label>
              <div class="daily-delta">
                <<- ejs.render($('#render_delta_template').html(), { delta: building.dailyDelta() }) >>
              </div>
            </div>
            <button class="manage" name="<<- building.name >>"><<- action >></button>
          </div>
        </div>
      << }) >>
    </div>
  </script>
  <script id="missions_list_template" type="text/ejs-template">
    <div class="vertical-tabs navigable" id="mission-list">
      <ul>
        << var i = 0 >>
        << for (var _id in missions) {
          if (!missions[_id].display) { continue; }
          i++ >>
          <li>
            <a href="#mission-tab-<<- i >>"><<- missions[_id].display.label >></a>
          </li>
        << } >>
      </ul>
      << i = 0 >>
      << $.each(missions, function(_id, mission) {
        if (!mission.display) { return; }
        i++ >>
        <div id="mission-tab-<<- i >>" class="mission ui-helper-clearfix">
          <img src="<<- mission.display.image >>">
          <div>
            <<- mission.display.text >>
          </div>
        </div>
      << }) >>
    </div>
  </script>
  <script id="actions_list_template" type="text/ejs-template">
    <div class="vertical-tabs navigable" id="actions">
      <ul>
        << for (var i in girls) { >>
          <li>
            <a href="#action-tab-<<- i >>"><<- girls[i].name >></a>
          </li>
        << } >>
      </ul>
      << for (i in girls) { >>
        <div id="action-tab-<<- i >>" class="accordion girl <<- girl.name == girls[i].name ? 'active' : '' >>" name="<<- girls[i].name >>">
          <h3>Morning</h3>
          <div class="ui-helper-clearfix morning <<- time == 'morning' ? 'active' : '' >>"></div>
          <h3>Evening</h3>
          <div class="ui-helper-clearfix evening <<- time == 'evening' ? 'active' : '' >>"></div>
        </div>
      << } >>
    </div>
  </script>
  <script id="actions_girl_template" type="text/ejs-template">
    <table class="action-list"><tbody>
      << $.each(actions._sortToObject('group'), function(group, action_group) { >>
        <tr>
          <td class="group">
            <label><<- group >></label>
          </td>
          <td>
            << action_group.forEach(function(action) { >>
              <div class="action <<- action.disabled ? 'disabled' : '' >>">
                <label>
                  <span title="<<= action.description >>" class="<<- action.option && action.options()._toArray().length > 1 ? 'options' : '' >>"><<- action.label >></span>
                  << if (action.option && action.options()._toArray().length > 1) { >>
                    <ol class="dropdown">
                      << $.each(action.options(), function(label, description) { >>
                        <li name="<<- label >>" class="<<- label == action.option ? 'selected' : '' >>"><<- description >></li>
                      << }) >>
                    </ol>
                  << } >>
                </label>
                <ul name="<<- action._id >>" class="others-<<- (otherActions[action._id] || []).length - (girl.actions[time] && girl.actions[time]._id == action._id) >>">
                  << for (var i in otherActions[action._id]) { >>
                    << if (otherActions[action._id][i] != girl.name) { >>
                      <li class="other">
                        <img src="<<- g.girls[otherActions[action._id][i]].image() >>" title="<<= otherActions[action._id][i] >>">
                      </li>
                    << } >>
                  << } >>
                  << if (girl.actions[time] && girl.actions[time]._id == action._id) { >>
                    <li class="this"><img src="<<- girl.image() >>"></li>
                  << } >>
                </ul>
              </div>
            << }) >>
          </td>
        </tr>
      << }) >>
    </tbody></table>
  </script>
</body></html>